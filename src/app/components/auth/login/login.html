<section class="login-page">
  <div class="login-card">
    <header class="login-header">
      <h1>Iniciar Sesi√≥n</h1>
      <p>Ingresa tus credenciales para acceder</p>
    </header>

    <!-- ‚ö†Ô∏è Banner de verificaci√≥n de email requerida -->
    <div class="verification-alert" *ngIf="needsEmailVerification()" role="alert">
      <div class="alert-icon">‚ö†Ô∏è</div>
      <div class="alert-content">
        <strong>Email no verificado</strong>
        <p>Debes verificar tu email antes de iniciar sesi√≥n. Revisa tu bandeja de entrada.</p>

        <!-- Mensaje de email enviado -->
        <div class="email-sent-message" *ngIf="emailSent()">
          <span class="success-icon">‚úì</span>
          Email de verificaci√≥n enviado. Revisa tu bandeja de entrada.
        </div>

        <!-- Bot√≥n de reenv√≠o -->
        <button type="button" class="btn-resend-small" (click)="resendVerificationEmail()"
          [disabled]="resendingEmail() || emailSent()">
          {{ resendingEmail() ? 'Enviando...' : emailSent() ? 'Email enviado ‚úì' : 'Reenviar email de verificaci√≥n' }}
        </button>
      </div>
    </div>

    <!-- üîÑ Banner de espera de verificaci√≥n (cuando est√° esperando que el usuario verifique desde el link) -->
    <div class="waiting-verification" *ngIf="waitingForVerification() && !loading()" role="status">
      <div class="spinner-small"></div>
      <div class="waiting-content">
        <strong>Esperando verificaci√≥n...</strong>
        <p>Haz clic en el enlace que enviamos a tu email. Esta p√°gina se actualizar√° autom√°ticamente cuando verifiques tu cuenta.</p>
      </div>
    </div>

    <!-- Mensaje de error general -->
    <div class="error-message" *ngIf="error() && !needsEmailVerification()" role="alert">
      {{ error() }}
    </div>

    <!-- Formulario de login -->
    <form (submit)="onSubmit(); $event.preventDefault()" class="login-form">
      <div class="form-group">
        <label for="email">Email o Usuario</label>
        <input id="email" type="text" [value]="email()" (input)="email.set($any($event.target).value)"
          placeholder="tu@email.com o tu_usuario" required autocomplete="username" />
      </div>

      <div class="form-group">
        <label for="password">Contrase√±a</label>
        <input id="password" type="password" [value]="password()" (input)="password.set($any($event.target).value)"
          placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" required autocomplete="current-password" />
      </div>

      <button type="submit" class="btn-login" [disabled]="loading()">
        {{ loading() ? 'Iniciando sesi√≥n...' : 'Iniciar Sesi√≥n' }}
      </button>
    </form>

    <footer class="login-footer">
      <p>¬øNo tienes cuenta? <a routerLink="/register">Reg√≠strate aqu√≠</a></p>
    </footer>
  </div>
</section>